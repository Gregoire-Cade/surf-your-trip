<div class="container">
  <div class="form-wrapper">
    <%= simple_form_for :search, method: "get", class: 'form-inline' do |f| %>
      <div class="form-row">
        <div class="col-3">
          <%= f.input :country,  as: :string, required: false,
                      input_html: {class: 'form-control-sm', style: "width: 200px;", value: params.dig(:search, :country) }%>
        </div>
         <div class="col-2">
          <%= f.input :level, collection: Spot.level.values, as: :radio_buttons, required: false, input_html: {class: 'form-control-sm', value: params.dig(:search, :level) }%>
        </div>
        <div class="col-2">
          <%= f.input :beach_type, collection: Spot.beach_type.values, as: :radio_buttons, required: false, input_html: {class: 'form-control-sm', value: params.dig(:search, :beach_type) }%>
        </div>
      </div>
      <%= f.submit "Search", class: "btn btn-primary" %>
      <%= link_to "Reset the search", spots_path, class: "btn btn-primary" %>

    <% end %>
  </div>
</div>

<div style="display: grid; grid-template-columns: 2fr 1.4fr; grid-gap: 2px;">

  <div class="cards my-5">
    <% @spots.each do |spot| %>
      <div class="card-spot">
        <% if spot.photos.attached? %>
          <%= link_to(cl_image_tag(spot.photos.first.key, height: 200, width: 350, crop: :fill), spot_path(spot)) %>
        <% end %>
        <div class="card-spot-infos d-flex justify-content-between align-items-start">
          <div>
            <h2><%= link_to spot.name, spot_path(spot) %></h2>
            <p>Level: <%= spot.level %> </p>
          </div>
          <div class="infos d-flex flex-column align-items-end">
           <h2><i class="fas fa-map-marker-alt " style="color: rgba(0,0,0,0.7);"></i>&nbsp;<%= spot.city %>, <%= spot.country %></h2>
           <p class="text-right"><% spot.waves.times do %>
            <%= image_tag("wave.png", width: 20, style: "margin-left: -6px;") %>
           <% end %>
          <br><i class="far fa-comment" style="color: rgba(0,0,0,0.6); "></i> <%= spot.reviews.count %> </p>
          </div>
        </div>
      </div>
    <% end %>
  </div>
  <div id="map"
     style="width: 100%; height: calc(100vh); position: sticky; top: 0; z-index: 500; box-shadow: 0 0 15px rgba(0,0,0,0.1);"
     data-markers="<%= @markers.to_json %>"
     data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
</div>
