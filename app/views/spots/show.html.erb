
<div class="container">
  <div class="container-carousel mt-5">
    <div class="carousel">
      <div id="carousel-spot" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <% @spot.photos.each_with_index do |photo, index| %>
          <li href="#carousel-spot" data-slide-to="<%= index %>" class=" <%= 'active' if index == 0 %> "></li>
          <% end %>
        </ol>
        <div class="carousel-inner">
          <% @spot.photos.each_with_index do |photo, index| %>
            <div class="carousel-item <%= 'active' if index == 0 %>" alt=" <%= index %>" style="background-image: url('<%= cl_image_path photo.key %>')">
              <%#= cl_image_tag photo.key, class: "d-block w-100" %>
            </div>
          <% end %>
        </div>
        <a class="carousel-control-prev" href="#carousel-spot" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carousel-spot" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
    </div>
    <div class="carousel-spot-infos d-flex justify-content-between align-items-end px-4">
      <div class="card-spot-infos">
        <h2><strong><%= @spot.name %></strong></h2>
        <br>
        <em><i class="fas fa-map-marker-alt px-1" style="color: rgba(0,0,0,0.7);"></i><%= @spot.city + " , " + @spot.country %></em>
        <br>
        <br>
        <!-- Button trigger modal -->
        <button type="button" class="btn btn-light" data-toggle="modal" data-target="#exampleModal">
          Confirm this spot
        </button>

        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Give us some details</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="container">
                <div class="form-wrapper" style="width: 400px; margin: 0 auto;">
                    <%= simple_form_for [@spot, @trip] do |f| %>
                  <div class="modal-body">
                      <%= f.input :surfers, as: :integer, label: false, placeholder: "We'll be 3 🏄🏄‍♂️🏄‍♀️ " %>
                      <%= f.input :start_date, as: :string, label: false, input_html: {class: "datepicker form-control", placeholder: "Start date"} %>
                      <%= f.input :end_date, as: :string, label: false, input_html: {class: "datepicker form-control", placeholder: "End date"} %>
                  </div>
                  <div class="modal-footer">
                    <%= f.submit "Surf my trip", class: "btn btn-primary" %>
                  </div>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card-spot-reviews">
        <p class="m-0"> <%= image_tag("wave.png", width: 22) %> <%= @spot.waves %> </p>
        <p><i class="far fa-comment mr-1" style="color: rgba(0,0,0,0.6); "></i> <%= @spot.reviews.count %> </p>
      </div>
    </div>
  </div>
</div>
<br>
<div class="container">
<%= link_to "Go back to Spots", spots_path, class: "btn btn-dark"%>
</div>
<br>
<p class="text-center"><em><%= @spot.punchline %></em></p>

<div class="spot-details-container" data-stormglass-api-key="<%= ENV['STORMGLASS_API_KEY'] %>" data-latitude="<%= @spot.latitude %>" data-longitude="<%= @spot.longitude %>" >
  <div class="spot-details row justify-content-between">

    <div class="spot-recap col-8">
      <div class="row m-0">
        <div class="col-8">
          <div class="wind-infos">
            <p><strong>About the spot: </strong><%= @spot.description %></p>
            <p><strong>About <%= @spot.city %> :</strong><%= @spot.about_location %></p>
            <div class="wind-spot-info">
              <p class="text-center">Wind infos:</p>
              <div class="compass" id="wind">
                <div class="direction">
                  <p id="wind-direction">SW<span id="windspeed">km/h</span></p>
                </div>
                <div class="arrow" id="wind-arrow"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-4">
          <em><p class="text-center">How's the weather atm? </p></em>
          <div class="container weather" style="display: grid; grid-template-rows: 1fr 1fr 1fr; grid-gap: 16px;">
            <div class="card air-temp">
              <div class="card-body">
                <h4>Air temp</h4>
                <%= image_tag("thermometer.png") %> <%= image_tag("air-weather.png") %>
                <h5><span id='airtemperature'>12</span>°</h5>
              </div>
            </div>
            <div class="card water-temp">
              <div class="card-body">
                <h4>Water temp</h4>
                <%= image_tag("thermometer.png") %> <%= image_tag("water-weather.png") %>
                <h5><span id='watertemperature'>8</span>°</h5>
              </div>
            </div>
            <div class="card wave-height">
              <div class="card-body">
                <h4>Wave height</h4>
                <%= image_tag("wave-show.png") %> <%= image_tag("wave-height.png") %>
                <h5><span id='waveheight'>1,3</span>m</h5>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="spot-forecast col-4">
      <div id="map"
        style="width: 100%; height: 600px;"
        data-markers="<%= @marker.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
    </div>
  </div>
  <br>

  <div class="container reviews mt-1 mb-3 justify-content-center" style="width:880px;">
    <div class="d-flex justify-content-between">
    <h4 class="mb-2">Reviews</h4>
    <%= link_to "Add a review", new_spot_review_path(@spot), class: "btn btn-primary"%>
    </div>
    <div class="container">
    <% @spot.reviews.each do |review| %>
      <div class="card d-flex align-content-center mt-4" style="width: 800px; border: none;">
       
        <div class="spot-review-infos d-flex justify-content-between mt-2">
          <div class="user d-flex align-items-center">
            <% if review.user.photo.attached? %>
              <%= (cl_image_tag(review.user.photo.key, height: 50, width: 50, crop: :fill, class: "avatar ml-2 ")) %>
            <% else %>
              <%= image_tag "avatar-default.png", height: 50, crop: :thumb, class: "avatar ml-2" %>
            <% end %>
              <p> &nbsp;&nbsp;<%= review.user.nickname %></p>
          </div>
          <div class="waves mr-4">
          <p><small> &nbsp;&nbsp;<%= review.created_at.strftime("%Y-%m-%d") %></small></p>
       
          </div>
        </div>
        
        <div class="review-content m-3">
    
          <p class="ml-1 mr-1"> <strong><%= review.title %></strong>   <% review.rating.times do %>
            <%= image_tag("wave.png", style: "height: 20px; width: 20px; margin-right: -4px;") %>
          <% end %></p>
          <p><%= review.content %></p>
        </div> 

         <div class="spot-review-photo">
          <% if review.photo.attached? %>
            <%= (cl_image_tag(review.photo.key, height: 100, width: 150, crop: :fill, class:"ml-2 mb-3 rounded" )) %>
          <% end %>
        </div>   
      </div>
    <% end %>

  </div>

</div>




<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
